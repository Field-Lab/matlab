function main = generateAnalysisGuiLayout(funH)

try
    icons = load('icons.mat');
    icons = icons.Icons;
catch
    disp(lasterror)
end

elecResp = [];

main.editTextFont = 'Courier';
main.smallFontSize = 9;
main.bootstrapReps = 100; %should be changeable by gui

%% constructs gui components

if strcmp('/', filesep) %mac
    main.gui = figure('Visible', 'off', 'Position',[75 75 1200 900],...
        'Name', 'Electrical Stimulation Analysis Main', 'Resize', 'off', 'Toolbar', 'none', 'Menubar', 'none');
else
    main.gui = figure('Visible', 'off', 'Position',[50 40 1200 730],...
        'Name', 'Electrical Stimulation Analysis Main', 'Resize', 'off', 'Toolbar', 'none', 'Menubar', 'none');
end
    

%% top left panel (settings) %%%%%%%%%%%%%%%%%%%
if strcmp('/', filesep) %mac
    main.topLeftPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [10 700 460 190],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0, 'Title', 'settings');
else %pc
    main.topLeftPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [10 530 460 190],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0, 'Title', 'settings');
end

% button group
main.modeButtons = uibuttongroup('Parent', main.topLeftPanel, 'Units', 'pixels',...
    'Position', [370 50 80 80], 'BorderType', 'line', 'BackgroundColor', 'white',...
    'HighlightColor', [0.7 0.7 0.7], 'BorderWidth', 3, 'SelectionChangeFcn', funH.switchMode);

uicontrol(main.modeButtons, 'Style', 'text', 'String', 'mode', 'FontWeight', 'bold',...
    'Position', [5 50 70 15], 'BackgroundColor', 'white')
main.analyzeModeButton = uicontrol(main.modeButtons, 'Style', 'radiobutton',...
    'String', 'analyze', 'Position', [5 30 70 20], 'Value', 1, 'BackgroundColor', [1 1 1]);
main.exploreModeButton = uicontrol(main.modeButtons, 'Style', 'radiobutton',...
    'String', 'explore', 'Position', [5 10 70 20], 'Value', 0, 'BackgroundColor', [1 1 1]);


% static text
main.filePathStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 160 130 15],...
    'String', 'path to elecResp .mat file', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
main.fileNameStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 135 130 15],...
    'String', 'name of elecResp .mat file', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
main.patternNoStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 110 130 15],...
    'String', 'pattern', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'Visible', 'off', 'fontsize', 9);
main.movieNoStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 110 130 15],...
    'String', 'movie number', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 85 130 15],...
    'String', 'display success/failures...', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 60 130 15],...
    'String', 'x-axis limits (plotting)', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
main.residLimStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 35 130 15],...
    'String', 'analysis region limits', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
main.tempOffsetStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [10 10 130 15],...
    'String', 'template offset limits', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
main.tempStepSizeStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [240 10 50 15],...
    'String', 'step size', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);
main.excludeRegStaticText = uicontrol(main.topLeftPanel, 'Style', 'text', 'Position', [240 30 50 15],...
    'String', ['ex. reg.'], 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'fontsize', 9);

% edit text boxes
if strcmp('/', filesep) %mac
    main.filePath = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '/snle/lab/Experiments/Array/Analysis/2011-06-24-5/data015/',...
        'Position', [150 160 300 25], 'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'FontName', main.editTextFont, 'Callback', funH.resetForNewData);
else %pc
    main.filePath = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', 'C:\Documents and Settings\Lauren Hruby\Desktop\lab\',...
        'Position', [150 160 300 25], 'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'FontName', main.editTextFont, 'Callback', funH.resetForNewData);
end
main.fileName = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', 'elecResp_n728_p340.mat',...
    'Position', [150 135 190 25], 'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.eiPath = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '/Volumes/Palace/Analysis/Lauren/2008-08-27-4/data000-lh/data000-lh.ei','visible', 'off', 'enable', 'off',...
    'Position', [150 135 300 25], 'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.movieNo = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '1',...
    'Position', [150 110 50 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.patternNo = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '1',...
    'Position', [150 110 50 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont,...
    'enable', 'off', 'Visible', 'off');
main.xAxisLimitLow = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '1',...
    'Position', [150 60 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.xAxisLimitHigh = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '45',...
    'Position', [195 60 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.centerElec = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '1', 'visible', 'off', 'enable', 'off',...
    'Position', [150 35 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.residualLimitLow = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '11',...
    'Position', [150 35 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.residualLimitHigh = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '40',...
    'Position', [195 35 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.offsetLimitLow = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '7',...
    'Position', [150 10 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.offsetLimitHigh = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '35',...
    'Position', [195 10 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.offsetStep = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '0.25',...
    'Position', [295 10 50 20], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);
main.spikeMinExclusionReg = uicontrol(main.topLeftPanel, 'Style', 'edit', 'String', '5',...
    'Position', [295 30 50 20], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'FontName', main.editTextFont);

%checkbox
main.fixedLimsCB = uicontrol(main.topLeftPanel, 'Style', 'checkbox', 'String', 'use elecResp',...
    'Position', [250 60 110 20], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white', 'fontsize', 9, 'callback', funH.switchLimMode);
main.fixedLimsCB2 = uicontrol(main.topLeftPanel, 'Style', 'text', 'String', 'limits',...
    'Position', [272 50 88 15], 'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'fontsize', 9);

%pushbuttons
try
    main.downButton = uicontrol(main.topLeftPanel,  'Style', 'pushbutton', 'CData', icons.downArrow,...
        'Position', [210 110 24 24], 'Callback', funH.decreaseMovieNo);
    main.upButton = uicontrol(main.topLeftPanel,  'Style', 'pushbutton', 'CData', icons.upArrow,...
        'Position', [240 110 24 24], 'Callback', funH.increaseMovieNo);
catch
    disp(lasterror)
    main.downButton = uicontrol(main.topLeftPanel,  'Style', 'pushbutton', 'String', 'down',...
        'Position', [210 112 35 20], 'Callback', funH.decreaseMovieNo);
    main.upButton = uicontrol(main.topLeftPanel,  'Style', 'pushbutton', 'String', 'up',...
        'Position', [250 112 35 20], 'Callback', funH.increaseMovieNo);
end

main.multiElecRespButton = uicontrol(main.topLeftPanel, 'Style', 'pushbutton', 'String', 'check multiple',...
    'Position', [350 135 100 25], 'Callback', funH.analyzeMultiple, 'FontSize', 9);

main.refreshButton = uicontrol(main.topLeftPanel,  'Style', 'pushbutton', 'String', 'refresh',...
    'Position', [370 10 80 30], 'Callback', funH.refreshAllDummy, 'FontSize', 12, 'FontWeight', 'bold',...
    'ForegroundColor', [1 0 1]);
    
%drop-down menu
main.dataDisplayType = uicontrol(main.topLeftPanel, 'Style', 'popupmenu',...
    'String', {'raw data', 'subtract mean trace', 'subtract estimated artifact'},...
    'Value', 2, 'Position', [150 80 200 25], 'BackgroundColor', [1 1 1], 'FontSize', 9);

%% top right panel (information) %%%%%%%%%%%%%%%%%%%
if strcmp('/', filesep)
    main.topRightPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [480 700 710 190],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0, 'Title', 'information');
else
    main.topRightPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [480 530 710 190],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0, 'Title', 'information');
end

% static text: left static

uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [20 150 140 15],...
    'String', 'dataset/name: ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [20 130 140 15],...
    'String', 'ei file: ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [20 110 140 15],...
    'String', 'pattern number: ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [20 90 140 15],...
    'String', 'number of pulses: ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);

uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [20 60 140 15],...
    'String', 'main recording electrode: ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [20 40 140 15],...
    'String', 'good recording electrode(s): ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);

% static text: left variable
main.text.name      = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [170 150 170 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.ei        = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [170 130 170 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.patternNo = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [170 110 170 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.nPulse    = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [170 90 170 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);

main.text.mainElec = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [170 60 170 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.goodElecs  = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [170 40 170 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);


% static text: right static
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [360 150 140 15],...
    'String', 'stimulus electrode(s): ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [360 130 140 15],...
    'String', 'stimulus amplitude(s) (uA): ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [360 100 140 15],...
    'String', 'target neuron: ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [360 80 140 15],...
    'String', 'active neuron(s): ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);
uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [360 50 140 15],...
    'String', 'analysis type used: ', 'BackgroundColor', 'white', 'HorizontalAlignment', 'right', 'FontSize', main.smallFontSize);


% static text: right variable
main.text.stimElec = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [510 150 150 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.stimAmps      = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [510 120 150 25],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.mainNeuron    = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [510 100 150 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.activeNeurons = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [510 80 150 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);
main.text.analysisType  = uicontrol(main.topRightPanel, 'Style', 'text', 'Position', [510 50 150 15],...
    'String', '', 'BackgroundColor', 'white', 'HorizontalAlignment', 'left', 'FontSize', main.smallFontSize);


%% mid left panel (actions) %%%%%%%%%%%%%%%%%%%
if strcmp('/', filesep)
    main.midLeftPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [10 445 400 245],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0, 'Title', 'actions');
else
    main.midLeftPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [10 275 400 245],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0, 'Title', 'actions');
end

%static text
main.reanalyizeStaticText = uicontrol(main.midLeftPanel, 'Style', 'text', 'Position', [10 210 75 15], 'String', '(re)analyze: ',...
    'HorizontalAlignment', 'right', 'BackgroundColor', 'white'); %visible in analyze mode

%drop-down menu
main.reanalyzeType = uicontrol(main.midLeftPanel, 'Style', 'popupmenu',...
    'String', {'linkage-based artifact', 'previous movie''s artifact', 'next movie''s artifact', 'TTX artifact','hand-picked artifact','current artifact', 'other occ. artifact'},...
    'Value', 2, 'Position', [20 185 200 25], 'BackgroundColor', [1 1 1]); %active/visible in analyze mode

%check-boxes
main.clearFlagsCheckBox = uicontrol(main.midLeftPanel,  'Style', 'checkbox', 'String', 'clear flags',...
    'Position', [240 210 100 20], 'BackgroundColor', [1 1 1], 'FontSize', main.smallFontSize); %active/visible in analyze mode
main.multipleMoviesCheckBox = uicontrol(main.midLeftPanel,  'Style', 'checkbox', 'String', 'multiple movies',...
    'Position', [240 195 100 20], 'BackgroundColor', [1 1 1], 'FontSize', main.smallFontSize); %active/visible in analyze mode
main.noRefitCheckBox = uicontrol(main.midLeftPanel,  'Style', 'checkbox', 'String', 'don''t refit',...
    'Position', [240 180 100 20], 'BackgroundColor', [1 1 1], 'FontSize', main.smallFontSize); %active/visible in analyze mode


%spacer
uicontrol('Style', 'text', 'Parent', main.midLeftPanel, 'Units', 'pixels', 'Position', [10 175 380 2],...
    'BackgroundColor', [0.7 0.7 0.7], 'String', '');

%pushbuttons
main.reanalyzeButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton', 'String', 'go',...
    'Position', [360 190 30 20], 'Callback', funH.reanalyze); %active/visible in analyze mode

main.exploreAnalyzeButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton', 'String', 'cluster manually',...
    'Position', [100 200 200 20], 'Callback', funH.tempAnalyze, 'visible', 'off', 'enable', 'off'); %active/visible in explore mode

main.showStimButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton', 'String', 'show stimulus',...
    'Position', [20 140 160 20], 'Callback', funH.showStimulus);
main.fitErfButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton', 'String', 'fit response rates to erf',...
    'Position', [20 110 160 20], 'Callback', funH.fitToErf);
main.findAllNeurons = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'find all neurons with signal', 'Position', [20 80 160 20], 'Callback', funH.findNeuronsOnElecs);

main.addActiveNeuron = uicontrol(main.midLeftPanel, 'Style', 'pushbutton',...
    'String', 'add active neuron', 'Position', [20 50 160 20], 'Callback', funH.addActiveNeuronDummy);

main.newElecResp = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'create new elecResp file', 'Position', [20 20 160 20], 'Callback', funH.createElecRespDummy);

main.removeFPButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'remove false positive', 'Position', [220 140 160 20], 'Callback', funH.removeFalsePos);
main.addMissButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'add missed spike', 'Position', [220 110 160 20], 'Callback', funH.addMissedSpike);

main.clearAnalysisButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'clear this analysis', 'Position', [220 86 160 15], 'Callback', funH.clearAnalysis);
main.clearRemainingAnalysisButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'clear remaining analyses', 'Position', [220 68 160 15], 'Callback', funH.clearRemainingAnalysis);
main.clearPrecedingAnalysisButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'clear preceding analyses', 'Position', [220 50 160 15], 'Callback', funH.clearPrecedingAnalysis);
main.lockLatenciesButton = uicontrol(main.midLeftPanel,  'Style', 'pushbutton',...
    'String', 'lock this analysis', 'Position', [220 20 160 20], 'Callback', funH.lockAnalysis);



%% mid mid panel (data plots) %%%%%%%%%%%%%%%%%%%
if strcmp('/', filesep)
    main.midMidPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [420 445 600 245],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0);
else
    main.midMidPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [420 275 600 245],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0);
end

main.lockAxisCheckBox = uicontrol(main.midMidPanel,  'Style', 'checkbox', 'String', 'lock y-axis',...
    'Position', [20 225 100 20], 'BackgroundColor', [1 1 1], 'FontSize', main.smallFontSize); %active/visible in analyze mode


main.altPlotsButton = uicontrol(main.midMidPanel, 'Style', 'pushbutton', 'String', 'alternative plots',...
    'Position', [120 225 100 20], 'Callback', funH.altPlots);

main.a1 = axes('Parent', main.midMidPanel, 'Units', 'pixels', 'Position', [25 25 260 195]);
main.a2 = axes('Parent', main.midMidPanel, 'Units', 'pixels', 'Position', [315 25 260 195]);

%% mid right panel (legend) %%%%%%%%%%%%%%%%%%%
if strcmp('/', filesep) %mac
    main.midRightPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [1030 445 160 245],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0);
else %pc
    main.midRightPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [1030 275 160 245],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0);
end

main.artFromSubsetCheckBox = uicontrol(main.midRightPanel, 'Style', 'checkbox', 'Units', 'pixels',...
    'Position', [10 210 130 20], 'String', 'exclude flagged', 'ForegroundColor', 'black',...
    'Visible', 'off', 'Value', 0, 'BackgroundColor', [1 1 1]);
main.artFromSubsetText = uicontrol(main.midRightPanel, 'style', 'text', 'Units', 'pixels',...
    'Position', [10 180 130 30], 'String', ['traces from', 10, 'subtracted artifact'],...
    'BackgroundColor', 'white', 'visible', 'off');

main.legendCheckBox1 = uicontrol(main.midRightPanel, 'Style', 'checkbox', 'Units', 'pixels',...
    'Position', [10 140 130 20], 'String', '', 'ForegroundColor', 'magenta',...
    'Fontweight', 'bold', 'Visible', 'off', 'Value', 1, 'BackgroundColor', [1 1 1]);
main.legendCheckBox2 = uicontrol(main.midRightPanel, 'Style', 'checkbox', 'Units', 'pixels',...
    'Position', [10 110 130 20], 'String', '', 'ForegroundColor', 'magenta',...
    'Fontweight', 'bold', 'Visible', 'off', 'Value', 1, 'BackgroundColor', [1 1 1]);
main.legendCheckBox3 = uicontrol(main.midRightPanel, 'Style', 'checkbox', 'Units', 'pixels',...
    'Position', [10 80 130 20], 'String', '', 'ForegroundColor', 'magenta',...
    'Fontweight', 'bold', 'Visible', 'off', 'Value', 1, 'BackgroundColor', [1 1 1]);

main.displayOtherTemplatesButton = uicontrol(main.midRightPanel, 'Style', 'pushbutton', 'Units', 'pixels',...
    'Position', [10 45 130 20], 'String', 'show other EIs', 'visible', 'off', 'enable', 'off',...
    'Callback', funH.displayOtherTemplates);

main.showTemplatesCheckbox = uicontrol(main.midRightPanel, 'Style', 'checkbox', 'Units', 'pixels',...
    'Position', [10 20 130 20], 'String', 'plot templates', 'visible', 'off', 'Value', 1, 'BackgroundColor', [1 1 1]);

% main.legendRefreshButton = uicontrol(main.midRightPanel, 'Style', 'pushbutton', 'Units', 'pixels',...
%     'Position', [30 20 100 20], 'String', 'refresh ei plots', 'visible', 'off', 'enable', 'off',...
%     'Callback', funH.refreshEiPlotsDummy);

main.eiRefreshCheckbox = uicontrol(main.midRightPanel, 'Style', 'checkbox', 'Units', 'pixels',...
    'Position', [10 20 130 20], 'String', 'refresh ei plots', 'visible', 'off', 'enable', 'off');

%% bottom panel (eis) %%%%%%%%%%%%%%%%%%%

if strcmp('/', filesep) %mac
    main.bottomPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [10 10 1180 425],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0);
else
    main.bottomPanel = uipanel(main.gui, 'Units', 'pixels', 'Position', [10 10 1180 255],...
        'BackgroundColor', 'white', 'Fontsize', 10, 'BorderType', 'line', 'HighlightColor', 'black',...
        'BorderWidth', 0);
end
%axes and associated pushbuttons


for ii = 1:7
    if strcmp('/', filesep) %mac
        main.aEi{1,ii} = axes('Parent', main.bottomPanel, 'Units', 'pixels', 'Position', [25+165*(ii-1) 250 140 140], 'visible', 'off');
        main.aButton{1,ii} = uicontrol(main.bottomPanel, 'Style', 'pushbutton', 'Position', [25+165*(ii-1) 395 115 20],...
            'visible', 'off', 'enable', 'off', 'Callback', funH.expandAxes);
        main.aCheckBox{1,ii} = uicontrol(main.bottomPanel, 'Style', 'checkbox', 'Position', [145+165*(ii-1) 395 20 20],...
            'visible', 'off', 'enable', 'off', 'value', 1);
        main.aEi{2,ii} = axes('Parent', main.bottomPanel, 'Units', 'pixels', 'Position', [25+165*(ii-1) 35 140 140], 'visible', 'off'); 
        main.aButton{2,ii} = uicontrol(main.bottomPanel, 'Style', 'pushbutton', 'Position', [25+165*(ii-1) 180 115 20],...
            'visible', 'off', 'enable', 'off', 'Callback', funH.expandAxes);
        main.aCheckBox{2,ii} = uicontrol(main.bottomPanel, 'Style', 'checkbox', 'Position', [145+165*(ii-1) 180 20 20],...
            'visible', 'off', 'enable', 'off', 'value', 1);
    else %pc
        main.aEi{1,ii} = axes('Parent', main.bottomPanel, 'Units', 'pixels', 'Position', [25+165*(ii-1) 80 140 140], 'visible', 'off');
        main.aButton{1,ii} = uicontrol(main.bottomPanel, 'Style', 'pushbutton', 'Position', [25+165*(ii-1) 225 115 20],...
            'visible', 'off', 'enable', 'off', 'Callback', funH.expandAxes);
        main.aCheckBox{1,ii} = uicontrol(main.bottomPanel, 'Style', 'checkbox', 'Position', [145+165*(ii-1) 225 20 20],...
            'visible', 'off', 'enable', 'off', 'value', 1);
    end
end


%visible in analyze mode if data has been analyzed
%spacer
if strcmp('/', filesep)
    main.bottomSpacer2 = uicontrol('Style', 'text', 'Parent', main.bottomPanel, 'Units', 'pixels', 'Position', [820 213 350 2],...
        'BackgroundColor', [0.7 0.7 0.7], 'String', '');
    main.bottomSpacer1 = uicontrol('Style', 'text', 'Parent', main.bottomPanel, 'Units', 'pixels', 'Position', [10 213 40 2],...
        'BackgroundColor', [0.7 0.7 0.7], 'String', '');
    
    main.exploreOtherElecsCheckBox = uicontrol(main.bottomPanel, 'Style', 'checkbox',...
        'String', 'explore other electrodes', 'Position', [60 205 170 20],...
        'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'Callback', funH.otherElecsSwitch);
    
    main.bottomPanelText = uicontrol(main.bottomPanel, 'Style', 'text', 'Position', [270 204 80 15],...
        'String', 'center electrode ', 'HorizontalAlignment', 'right', 'BackgroundColor', 'white',...
        'visible', 'off');
    main.centerExploreNoSpikes = uicontrol(main.bottomPanel, 'Style', 'edit', 'String', '1',...
        'Position', [360 203 40 25], 'HorizontalAlignment', 'center', 'BackgroundColor', 'white',...
        'FontName', main.editTextFont, 'enable', 'off', 'visible', 'off');
    main.subtractSpikesCheckBox = uicontrol(main.bottomPanel, 'Style', 'checkbox',...
        'String', 'subtract identified spikes', 'Position', [420 205 180 20],...
        'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'enable', 'off', 'visible', 'off');
    main.excludeSpikeTracesCheckBox = uicontrol(main.bottomPanel, 'Style', 'checkbox',...
        'String', 'exclude identified spikes', 'Position', [620 205 180 20],...
        'HorizontalAlignment', 'left', 'BackgroundColor', 'white', 'enable', 'off', 'visible', 'off');
end
