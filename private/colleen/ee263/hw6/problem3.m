%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Clean up workspace and define problem data
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear all; close all; clc

A = [0.5 1.0 0.1;
    -0.1 0.5 -0.1;
    0.2 0.0 0.9];
B = [1; 0; 0];
C = [0 1 0];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Iterate over K
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
K = -5:0.01:5;
lambda = nan(length(K),1);
for i = 1:length(K)
    lambda(i) = max(eigs(A+B*K(i)*C));
end
Kopt = K(lambda == min(lambda))