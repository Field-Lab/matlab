% problem 3a
A = [-.1005 1.0939 2.0428 4.4599;
    -1.0880 -0.1444 5.9859 -3.0481;
    -2.0510 -5.9709 -0.1387 1.9229;
    -4.4575 3.0753 -1.8847 -0.1164];
eigenvalues = eig(A);

% problem 3b
t=0:100;
x0 = ones(4,1);
x = nan(4,length(t));
for i = 1:length(t)
    x(:,i) = expm(t(i)*A)*x0;
end
figure();
plot(t,sqrt(sum(x.^2,1)));
title('Problem 3b');
xlabel('t');
ylabel('norm(x)');

% problem 3c
Z = expm(15*A);
Y = expm(-20*A);
% Z =
% 
%     0.2032   -0.0068   -0.0552   -0.0708
%     0.0340    0.0005   -0.0535    0.1069
%     0.0173    0.1227    0.0270    0.0616
%     0.0815    0.0186    0.1151    0.1298
% Y =
% 
%     6.2557    3.3818    1.7034    2.2064
%    -2.1630   -2.8107  -14.2950   12.1503
%    -3.3972   17.3931   -1.6257   -2.8004
%    -1.7269   -6.5353   10.7081    2.9736

% problem 3f
x0_f = expm(-10*A)*ones(4,1);