function slider = make_loop_slider_getpts(start_index,index_min,index_max)
% GUI slider for loop over plot for manual inspection
% by clicking button, user can select points
%
%    start_index=1; index_min=1; index_max=10;
%    mat=rand(100,index_max);
%
%    slider = make_loop_slider_list(start_index,index_min,index_max);
%    keep_going = 1;
%    while keep_going
%       k = round(get(slider,'Value'));
%       plot(mat(:,k));
%       if exist('x','var');disp([x y]);clear x y;end
%       pts_axes = gca;
%       uiwait;
%    end
%
% 2009 greschner
% 2009-09  gauthier, added point selection
%

% button to select ROI
b1= uicontrol('Style','pushbutton', ...
    'Units','normalized', ...
    'Position',[0.7 0 .1 .08], ...
    'String','polygon',...
    'Callback','[ROI, roi, yi] = roipoly; uiresume;');

% button to add a point
b2= uicontrol('Style','pushbutton', ...
    'Units','normalized', ...
    'Position',[0.8 0 .1 .08], ...
    'String','points',...
    'Callback','[x,y]=getpts(pts_axes); uiresume;');

% button to finish
b3= uicontrol('Style','pushbutton', ...
    'Units','normalized', ...
    'Position',[0.9 0 .1 .08], ...
    'String','done',...
    'Callback','uiresume; keep_going = 0;');

% slider
slider = uicontrol(gcf,...
    'Style','slider',...
    'Min' ,index_min,'Max',index_max, ...
    'Units','normalized', ...
    'Position',[0,0,0.7,.04], ...
    'Value', start_index,...
    'SliderStep',1/(index_max-index_min) * [1 1],...
    'CallBack', 'uiresume;');

set(gcf,'Toolbar','figure')
