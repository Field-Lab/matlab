function printglmfit(fittedGLM,printname)

info    = fittedGLM.cellinfo;
GLMType = fittedGLM.GLMType;
dt = fittedGLM.t_bin;
tstim = fittedGLM.bins_per_frame * dt;
performance = fittedGLM.xvalperformance;
if GLMType.TonicDrive
    MU = fittedGLM.linearfilters.TonicDrive.Filter;
end
if GLMType.PostSpikeFilter
    PS = fittedGLM.linearfilters.PostSpike.Filter;
end

K        = fittedGLM.linearfilters.Stimulus.Filter;
K_time1  = fittedGLM.linearfilters.Stimulus.time_rk1; 
K_space1 = fittedGLM.linearfilters.Stimulus.space_rk1; 
    
clf
subplot(5,1,1)
axis off
set(gca, 'fontsize', 12)
c = 0;
c = c + 1.2;
text(-.1, 1-0.1*c,sprintf('%s: %s %d: %s-Fit',info.exp_nm, info.celltype,info.cid, GLMType.fit_type))
c = c + 1.2;
text(-.1, 1-0.1*c,sprintf('Xval performance, normed by unconditioned optimal performance (UOP) %1.3e',performance.glm_normedbits))
 c = c + 1.2;
text(-.1, 1-0.1*c,sprintf('Fit Type: %s',GLMType.fitname))
c = c + 1.2;
text(-.1, 1-0.1*c,sprintf('Tonic drive with gray stim: %1.2e hz',round(exp(MU)))  )
c = c + 1.2;
text(-.1, 1-0.1*c,sprintf('Optimum fmin: %1.4e',fittedGLM.rawfit.objective_val))

c = c + 1.2;
text(-.1, 1-0.1*c,sprintf('Raw xval bitsperspike %1.3e',performance.logprob_glm_bpspike))
c = c + 1.2;
text(-.1, 1-0.1*c,sprintf('Computated at %s',fittedGLM.fit_time))
    

subplot(5,4,[5 9])  % label in 50 msec intervals
imagesc(K_space1);

subplot(5,4,[6,10])
plot(K_time1);

subplot(5,4,[7,11])
plot(exp(PS));

subplot(5,4,[8,12]);
text(.3,.5,'CP here'); axis off

subplot(5,1,[4,5]);

secs     = 8;
bins     = 120 * 8 * fittedGLM.bins_per_frame;
rec_rast = fittedGLM.xvalperformance.rasters.recorded(:,1:bins);
sim_rast = fittedGLM.xvalperformance.rasters.glm_sim(:,1:bins); 
trials   = size(rec_rast,1);
time     = dt*[1:bins];
xlim([0, ceil(time(end))]);
ylim([1 , 2*trials]); hold on

for i_trial = 1:trials
    sim1 = time(find(sim_rast(i_trial,:)));
    rec1 = time(find(rec_rast(i_trial,:)));
    
    plot(rec1, i_trial, 'k.')
    plot(sim1, i_trial + trials, 'r.')
end
    
    
    




orient landscape
eval(sprintf('print -dpdf %s.pdf',printname))
end

    



     