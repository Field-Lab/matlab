ALL DONE BEFORE VISITING STANFORD  JUNE 2015

This is an old version with a hack fix to make sure that net gain did not exceed one!

Needs to be reworked!!

